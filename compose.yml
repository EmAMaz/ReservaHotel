name: reserva-hotel

services:
  db:
    image: mysql
    restart: always
    env_file:
      - ./apps/backend/.env
    ports:
      - 3306:3306
    healthcheck:
      test:
        [
          "CMD",
          "mysqladmin",
          "ping",
          "-h",
          "localhost",
          "-u$$MYSQL_USER",
          "-p$$MYSQL_PASSWORD",
        ]
      interval: 10s
      timeout: 5s
      retries: 5

  backend:
    build: ./apps/backend
    container_name: reserva-hotel-backend
    image: reserva-hotel-backend:latest
    env_file:
      - ./apps/backend/.env
    ports:
      - 3000:3000
    depends_on:
      db:
        condition: service_healthy

  frontend:
    build: ./apps/frontend
    container_name: reserva-hotel-frontend
    env_file:
      - ./apps/frontend/.env
    ports:
      - "5173:5173"
    depends_on:
      - backend
